<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/head :: head(title='Crear Grupo de Viaje')">
</head>

<body>
    <header th:replace="fragments/navbar :: navbar"></header>

    <main class="container my-5">
        <div class="row">
            <div class="col-12">
                <h1 class="mb-4">Crear Nuevo Grupo de Viaje</h1>

                <!-- Mensajes de error -->
                <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
                    <span th:text="${error}"></span>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>

                <form th:action="@{/crear-grupo}" th:object="${datosViaje}" method="post" class="needs-validation" novalidate>
                    <div class="card mb-4">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">Información del Grupo</h5>
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <!-- Nombre del viaje -->
                                <div class="col-md-6">
                                    <label for="nombreViaje" class="form-label">Nombre del Viaje *</label>
                                    <input type="text" class="form-control" id="nombreViaje" th:field="*{nombreViaje}" required>
                                    <div class="invalid-feedback" th:if="${#fields.hasErrors('nombreViaje')}" th:errors="*{nombreViaje}">
                                        El nombre del viaje es obligatorio.
                                    </div>
                                </div>

                                <!-- Tipo de grupo -->
                                <div class="col-md-6">
                                    <label for="tipoGrupo" class="form-label">Tipo de Grupo *</label>
                                    <select class="form-select" id="tipoGrupo" th:field="*{tipoGrupo}" required>
                                        <option value="">Selecciona un tipo</option>
                                        <option value="Público">Público</option>
                                        <option value="Privado">Privado</option>
                                        <option value="Solo Invitación">Solo Invitación</option>
                                    </select>
                                    <div class="invalid-feedback" th:if="${#fields.hasErrors('tipoGrupo')}" th:errors="*{tipoGrupo}">
                                        El tipo de grupo es obligatorio.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card mb-4">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">Información del Viaje</h5>
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <!-- Destino principal -->
                                <div class="col-md-6">
                                    <label for="destinoPrincipal" class="form-label">Destino Principal *</label>
                                    <input type="text" class="form-control" id="destinoPrincipal" th:field="*{destinoPrincipal}" required>
                                    <div class="invalid-feedback" th:if="${#fields.hasErrors('destinoPrincipal')}" th:errors="*{destinoPrincipal}">
                                        El destino principal es obligatorio.
                                    </div>
                                </div>

                                <!-- Tipo de viaje -->
                                <div class="col-md-6">
                                    <label for="idTipoViaje" class="form-label">Tipo de Viaje</label>
                                    <select class="form-select" id="idTipoViaje" th:field="*{idTipoViaje}">
                                        <option value="">Selecciona un tipo</option>
                                        <option th:each="tipo : ${tiposViaje}" th:value="${tipo.idTipo}" th:text="${tipo.nombreTipo}"></option>
                                    </select>
                                </div>

                                <!-- Fecha inicio -->
                                <div class="col-md-6">
                                    <label for="fechaInicio" class="form-label">Fecha de Inicio *</label>
                                    <input type="date" class="form-control" id="fechaInicio" th:field="*{fechaInicio}" required>
                                    <div class="invalid-feedback" th:if="${#fields.hasErrors('fechaInicio')}" th:errors="*{fechaInicio}">
                                        La fecha de inicio es obligatoria.
                                    </div>
                                </div>

                                <!-- Fecha fin -->
                                <div class="col-md-6">
                                    <label for="fechaFin" class="form-label">Fecha de Fin *</label>
                                    <input type="date" class="form-control" id="fechaFin" th:field="*{fechaFin}" required>
                                    <div class="invalid-feedback" th:if="${#fields.hasErrors('fechaFin')}" th:errors="*{fechaFin}">
                                        La fecha de fin es obligatoria.
                                    </div>
                                </div>

                                <!-- Descripción -->
                                <div class="col-12">
                                    <label for="descripcion" class="form-label">Descripción *</label>
                                    <textarea class="form-control" id="descripcion" th:field="*{descripcion}" rows="4" required></textarea>
                                    <div class="invalid-feedback" th:if="${#fields.hasErrors('descripcion')}" th:errors="*{descripcion}">
                                        La descripción es obligatoria.
                                    </div>
                                </div>

                                <!-- Punto de encuentro -->
                                <div class="col-12">
                                    <label for="puntoEncuentro" class="form-label">Punto de Encuentro *</label>
                                    <textarea class="form-control" id="puntoEncuentro" th:field="*{puntoEncuentro}" rows="2" required></textarea>
                                    <div class="invalid-feedback" th:if="${#fields.hasErrors('puntoEncuentro')}" th:errors="*{puntoEncuentro}">
                                        El punto de encuentro es obligatorio.
                                    </div>
                                </div>

                                <!-- Imagen destacada -->
                                <div class="col-12">
                                    <label for="imagenDestacada" class="form-label">URL de Imagen Destacada</label>
                                    <input type="text" class="form-control" id="imagenDestacada" th:field="*{imagenDestacada}">
                                </div>

                                <!-- Rango de edad -->
                                <div class="col-md-6">
                                    <label for="rangoEdadMin" class="form-label">Edad Mínima</label>
                                    <input type="number" class="form-control" id="rangoEdadMin" th:field="*{rangoEdadMin}" min="0" max="120">
                                </div>

                                <div class="col-md-6">
                                    <label for="rangoEdadMax" class="form-label">Edad Máxima</label>
                                    <input type="number" class="form-control" id="rangoEdadMax" th:field="*{rangoEdadMax}" min="0" max="120">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a th:href="@{/grupos}" class="btn btn-secondary me-md-2">Cancelar</a>
                        <button type="submit" class="btn btn-primary">Crear Grupo</button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <footer th:replace="fragments/footer :: footer"></footer>

    <!-- Script para validación del formulario -->
    <script>
        // Example starter JavaScript for disabling form submissions if there are invalid fields
        (function () {
            'use strict'

            // Fetch all the forms we want to apply custom Bootstrap validation styles to
            var forms = document.querySelectorAll('.needs-validation')

            // Loop over them and prevent submission
            Array.prototype.slice.call(forms)
                .forEach(function (form) {
                    form.addEventListener('submit', function (event) {
                        if (!form.checkValidity()) {
                            event.preventDefault()
                            event.stopPropagation()
                        }

                        form.classList.add('was-validated')
                    }, false)
                })
        })()
    </script>
</body>

</html>